import { findDirectoryWithin, getNameByPath, renameFileInDir } from "./DirectoryManagers";
import { path } from "./path";
import { BrowserDmFileReader } from "./BrowserDmFileReader";
export class SafariDirectoryManager {
    constructor(path = '', files) {
        this.path = path;
        this.files = files;
        this.name = getNameByPath(path);
    }
    async renameFile(oldFileName, newFileName) {
        return renameFileInDir(oldFileName, newFileName, this);
    }
    /** ⚠️ does not actually work */
    removeEntry(_name, _options) {
        throw 'removeEntry does not work in Safari';
    }
    findDirectory(path, options) {
        return findDirectoryWithin(path, this, options);
    }
    /** ⚠️ does not actually work */
    createDirectory(newPath) {
        return this.getDirectory(newPath);
    }
    async getDirectory(path) {
        // safari gives you all items up front
        const nextItems = this.files.filter(file => {
            const relative = getWebkitPathRelativeTo(file, this.path);
            return relative.substring(0, path.length).toLowerCase() === path.toLowerCase();
        });
        return new SafariDirectoryManager(path, nextItems);
    }
    getRelativeItems() {
        return this.files.filter(file => {
            const relative = getWebkitPathRelativeTo(file, this.path);
            return relative.split('/').length === 1; // lives within same directory
        });
    }
    async list() {
        return this.getRelativeItems().map(file => file.name);
    }
    async listFolders() {
        return this.getRelativeItems()
            .filter(file => file.name.split('.').length === 1)
            .map(file => file.name);
    }
    async listFiles() {
        return this.getRelativeItems().map(file => file.name);
    }
    async getFolders() {
        return Promise.all((await this.listFolders()).map(async (name) => await this.getDirectory(name)));
    }
    async getFiles() {
        return this.getRelativeItems().map(file => new BrowserDmFileReader(file, this));
    }
    async findFileByPath(filePath) {
        if (!this.files.length) {
            return;
        }
        // safari include the parent folder name so we need to prepend it to the file search
        const rootName = this.files[0].webkitRelativePath.split('/').shift();
        filePath = path.join(rootName, this.path, filePath);
        // safari just gives us every files upfront, find within that (huge) array
        const file = this.files.find(file => file.webkitRelativePath === filePath);
        return file ? new BrowserDmFileReader(file, this) : undefined;
    }
    async file(fileName, _options) {
        const findFile = await this.findFileByPath(fileName);
        if (findFile) {
            return findFile;
        }
        const superFile = new BrowserDmFileReader(new File([], fileName), this);
        return Promise.resolve(superFile);
    }
}
function getWebkitPathRelativeTo(file, path) {
    const relativeSplit = file.webkitRelativePath.split('/');
    relativeSplit.shift(); // remove the first notation on safari results
    if (path !== '') {
        let splitCount = path.split('/').length;
        while (splitCount) {
            relativeSplit.shift(); // remove starting notations on safari results
            --splitCount;
        }
    }
    return relativeSplit.join('/');
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2FmYXJpRGlyZWN0b3J5TWFuYWdlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZGlyZWN0b3J5LW1hbmFnZXJzL1NhZmFyaURpcmVjdG9yeU1hbmFnZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBb0IsbUJBQW1CLEVBQUUsYUFBYSxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFBO0FBQzNHLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxRQUFRLENBQUE7QUFFN0IsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sdUJBQXVCLENBQUE7QUFFM0QsTUFBTSxPQUFPLHNCQUFzQjtJQUdqQyxZQUNTLE9BQWUsRUFBRSxFQUNqQixLQUFhO1FBRGIsU0FBSSxHQUFKLElBQUksQ0FBYTtRQUNqQixVQUFLLEdBQUwsS0FBSyxDQUFRO1FBRXBCLElBQUksQ0FBQyxJQUFJLEdBQUcsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQ2pDLENBQUM7SUFFRCxLQUFLLENBQUMsVUFBVSxDQUNkLFdBQW1CLEVBQ25CLFdBQW1CO1FBRW5CLE9BQU8sZUFBZSxDQUFDLFdBQVcsRUFBRSxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUE7SUFDeEQsQ0FBQztJQUVELGdDQUFnQztJQUNoQyxXQUFXLENBQ1QsS0FBYSxFQUNiLFFBQWlDO1FBRWpDLE1BQU0scUNBQXFDLENBQUE7SUFDN0MsQ0FBQztJQUVELGFBQWEsQ0FDWCxJQUFZLEVBQ1osT0FBdUM7UUFFdkMsT0FBTyxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFBO0lBQ2pELENBQUM7SUFFRCxnQ0FBZ0M7SUFDaEMsZUFBZSxDQUFDLE9BQWU7UUFDN0IsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFRCxLQUFLLENBQUMsWUFBWSxDQUFDLElBQVk7UUFDN0Isc0NBQXND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QUFPLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQTtJQUMvRCxDQUFDO0lBRUQsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFnQixFQUFFLFFBQW1DO1FBQzlELE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQTtRQUVwRCxJQUFLLFFBQVEsRUFBRztZQUNkLE9BQU8sUUFBUSxDQUFBO1NBQ2hCO1FBRUQsTUFBTSxTQUFTLEdBQUcsSUFBSSxtQkFBbUIsQ0FBQyxJQUFJLElBQUksQ0FBQyxFQUFFLEVBQUUsUUFBUSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUE7UUFDdkUsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFBO0lBQ25DLENBQUM7Q0FDRjtBQUVELFNBQVMsdUJBQXVCLENBQUMsSUFBVSxFQUFFLElBQVk7SUFDdkQsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUN4RCxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUEsQ0FBQyw4Q0FBOEM7SUFDcEUsSUFBSyxJQUFJLEtBQUssRUFBRSxFQUFHO1FBQ2pCLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFBO1FBQ3ZDLE9BQU8sVUFBVSxFQUFFO1lBQ2pCLGFBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQSxDQUFDLDhDQUE4QztZQUNwRSxFQUFFLFVBQVUsQ0FBQTtTQUNiO0tBQ0Y7SUFDRCxPQUFPLGFBQWEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7QUFDaEMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdG9yeU1hbmFnZXIsIGZpbmREaXJlY3RvcnlXaXRoaW4sIGdldE5hbWVCeVBhdGgsIHJlbmFtZUZpbGVJbkRpciB9IGZyb20gXCIuL0RpcmVjdG9yeU1hbmFnZXJzXCJcbmltcG9ydCB7IHBhdGggfSBmcm9tIFwiLi9wYXRoXCJcbmltcG9ydCB7IERtRmlsZVJlYWRlciB9IGZyb20gXCIuL0RtRmlsZVJlYWRlclwiXG5pbXBvcnQgeyBCcm93c2VyRG1GaWxlUmVhZGVyIH0gZnJvbSBcIi4vQnJvd3NlckRtRmlsZVJlYWRlclwiXG5cbmV4cG9ydCBjbGFzcyBTYWZhcmlEaXJlY3RvcnlNYW5hZ2VyIGltcGxlbWVudHMgRGlyZWN0b3J5TWFuYWdlciB7XG4gIG5hbWU6IHN0cmluZ1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBwYXRoOiBzdHJpbmcgPSAnJyxcbiAgICBwdWJsaWMgZmlsZXM6IEZpbGVbXSxcbiAgKSB7XG4gICAgdGhpcy5uYW1lID0gZ2V0TmFtZUJ5UGF0aChwYXRoKVxuICB9XG5cbiAgYXN5bmMgcmVuYW1lRmlsZShcbiAgICBvbGRGaWxlTmFtZTogc3RyaW5nLFxuICAgIG5ld0ZpbGVOYW1lOiBzdHJpbmdcbiAgKSB7XG4gICAgcmV0dXJuIHJlbmFtZUZpbGVJbkRpcihvbGRGaWxlTmFtZSwgbmV3RmlsZU5hbWUsIHRoaXMpXG4gIH1cblxuICAvKiog4pqg77iPIGRvZXMgbm90IGFjdHVhbGx5IHdvcmsgKi9cbiAgcmVtb3ZlRW50cnkoXG4gICAgX25hbWU6IHN0cmluZyxcbiAgICBfb3B0aW9ucz86IHsgcmVjdXJzaXZlOiBib29sZWFuIH1cbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhyb3cgJ3JlbW92ZUVudHJ5IGRvZXMgbm90IHdvcmsgaW4gU2FmYXJpJ1xuICB9XG5cbiAgZmluZERpcmVjdG9yeSAoXG4gICAgcGF0aDogc3RyaW5nLFxuICAgIG9wdGlvbnM/OiBGaWxlU3lzdGVtR2V0RGlyZWN0b3J5T3B0aW9ucyxcbiAgKTogUHJvbWlzZTxEaXJlY3RvcnlNYW5hZ2VyIHwgdW5kZWZpbmVkPiB7XG4gICAgcmV0dXJuIGZpbmREaXJlY3RvcnlXaXRoaW4ocGF0aCwgdGhpcywgb3B0aW9ucylcbiAgfVxuXG4gIC8qKiDimqDvuI8gZG9lcyBub3QgYWN0dWFsbHkgd29yayAqL1xuICBjcmVhdGVEaXJlY3RvcnkobmV3UGF0aDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0b3J5KG5ld1BhdGgpXG4gIH1cblxuICBhc3luYyBnZXREaXJlY3RvcnkocGF0aDogc3RyaW5nKSB7XG4gICAgLy8gc2FmYXJpIGdpdmVzIHlvdSBhbGwgaXRlbXMgdXAgZnJvbnRcbiAgICBjb25zdCBuZXh0SXRlbXMgPSB0aGlzLmZpbGVzLmZpbHRlcihmaWxlID0+IHtcbiAgICAgIGNvbnN0IHJlbGF0aXZlID0gZ2V0V2Via2l0UGF0aFJlbGF0aXZlVG8oZmlsZSwgdGhpcy5wYXRoKVxuICAgICAgcmV0dXJuIHJlbGF0aXZlLnN1YnN0cmluZygwLCBwYXRoLmxlbmd0aCkudG9Mb3dlckNhc2UoKSA9PT0gcGF0aC50b0xvd2VyQ2FzZSgpXG4gICAgfSlcbiAgICByZXR1cm4gbmV3IFNhZmFyaURpcmVjdG9yeU1hbmFnZXIocGF0aCwgbmV4dEl0ZW1zKVxuICB9XG5cbiAgZ2V0UmVsYXRpdmVJdGVtcygpIHtcbiAgICByZXR1cm4gdGhpcy5maWxlcy5maWx0ZXIoZmlsZSA9PiB7XG4gICAgICBjb25zdCByZWxhdGl2ZSA9IGdldFdlYmtpdFBhdGhSZWxhdGl2ZVRvKGZpbGUsIHRoaXMucGF0aClcbiAgICAgIHJldHVybiByZWxhdGl2ZS5zcGxpdCgnLycpLmxlbmd0aCA9PT0gMSAvLyBsaXZlcyB3aXRoaW4gc2FtZSBkaXJlY3RvcnlcbiAgICB9KVxuICB9XG5cbiAgYXN5bmMgbGlzdCgpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UmVsYXRpdmVJdGVtcygpLm1hcChmaWxlID0+IGZpbGUubmFtZSlcbiAgfVxuXG4gIGFzeW5jIGxpc3RGb2xkZXJzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICByZXR1cm4gdGhpcy5nZXRSZWxhdGl2ZUl0ZW1zKClcbiAgICAgIC5maWx0ZXIoZmlsZSA9PiBmaWxlLm5hbWUuc3BsaXQoJy4nKS5sZW5ndGggPT09IDEpXG4gICAgICAubWFwKGZpbGUgPT4gZmlsZS5uYW1lKVxuICB9XG5cbiAgYXN5bmMgbGlzdEZpbGVzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICByZXR1cm4gdGhpcy5nZXRSZWxhdGl2ZUl0ZW1zKCkubWFwKGZpbGUgPT4gZmlsZS5uYW1lKVxuICB9XG4gIFxuICBhc3luYyBnZXRGb2xkZXJzKCk6IFByb21pc2U8U2FmYXJpRGlyZWN0b3J5TWFuYWdlcltdPiB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFxuICAgICAgKGF3YWl0IHRoaXMubGlzdEZvbGRlcnMoKSkubWFwKGFzeW5jIG5hbWUgPT4gYXdhaXQgdGhpcy5nZXREaXJlY3RvcnkobmFtZSkpXG4gICAgKVxuICB9XG5cbiAgYXN5bmMgZ2V0RmlsZXMoKTogUHJvbWlzZTxEbUZpbGVSZWFkZXJbXT4ge1xuICAgIHJldHVybiB0aGlzLmdldFJlbGF0aXZlSXRlbXMoKS5tYXAoZmlsZSA9PiBuZXcgQnJvd3NlckRtRmlsZVJlYWRlcihmaWxlLCB0aGlzKSlcbiAgfVxuXG4gIGFzeW5jIGZpbmRGaWxlQnlQYXRoIChmaWxlUGF0aDogc3RyaW5nICk6IFByb21pc2U8QnJvd3NlckRtRmlsZVJlYWRlciB8IHVuZGVmaW5lZD4ge1xuICAgIGlmICggIXRoaXMuZmlsZXMubGVuZ3RoICkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gc2FmYXJpIGluY2x1ZGUgdGhlIHBhcmVudCBmb2xkZXIgbmFtZSBzbyB3ZSBuZWVkIHRvIHByZXBlbmQgaXQgdG8gdGhlIGZpbGUgc2VhcmNoXG4gICAgY29uc3Qgcm9vdE5hbWUgPSB0aGlzLmZpbGVzWzBdLndlYmtpdFJlbGF0aXZlUGF0aC5zcGxpdCgnLycpLnNoaWZ0KCkgYXMgc3RyaW5nXG4gICAgZmlsZVBhdGggPSBwYXRoLmpvaW4ocm9vdE5hbWUsIHRoaXMucGF0aCwgZmlsZVBhdGgpXG4gICAgXG4gICAgLy8gc2FmYXJpIGp1c3QgZ2l2ZXMgdXMgZXZlcnkgZmlsZXMgdXBmcm9udCwgZmluZCB3aXRoaW4gdGhhdCAoaHVnZSkgYXJyYXlcbiAgICBjb25zdCBmaWxlID0gdGhpcy5maWxlcy5maW5kKGZpbGUgPT4gZmlsZS53ZWJraXRSZWxhdGl2ZVBhdGggPT09IGZpbGVQYXRoKSBhcyBGaWxlIHwgdW5kZWZpbmVkXG4gICAgcmV0dXJuIGZpbGUgPyBuZXcgQnJvd3NlckRtRmlsZVJlYWRlcihmaWxlLCB0aGlzKSA6IHVuZGVmaW5lZFxuICB9XG5cbiAgYXN5bmMgZmlsZShmaWxlTmFtZTogc3RyaW5nLCBfb3B0aW9ucz86IEZpbGVTeXN0ZW1HZXRGaWxlT3B0aW9ucykge1xuICAgIGNvbnN0IGZpbmRGaWxlID0gYXdhaXQgdGhpcy5maW5kRmlsZUJ5UGF0aChmaWxlTmFtZSlcblxuICAgIGlmICggZmluZEZpbGUgKSB7XG4gICAgICByZXR1cm4gZmluZEZpbGVcbiAgICB9XG5cbiAgICBjb25zdCBzdXBlckZpbGUgPSBuZXcgQnJvd3NlckRtRmlsZVJlYWRlcihuZXcgRmlsZShbXSwgZmlsZU5hbWUpLCB0aGlzKVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoc3VwZXJGaWxlKVxuICB9XG59XG5cbmZ1bmN0aW9uIGdldFdlYmtpdFBhdGhSZWxhdGl2ZVRvKGZpbGU6IEZpbGUsIHBhdGg6IHN0cmluZykge1xuICBjb25zdCByZWxhdGl2ZVNwbGl0ID0gZmlsZS53ZWJraXRSZWxhdGl2ZVBhdGguc3BsaXQoJy8nKVxuICByZWxhdGl2ZVNwbGl0LnNoaWZ0KCkgLy8gcmVtb3ZlIHRoZSBmaXJzdCBub3RhdGlvbiBvbiBzYWZhcmkgcmVzdWx0c1xuICBpZiAoIHBhdGggIT09ICcnICkge1xuICAgIGxldCBzcGxpdENvdW50ID0gcGF0aC5zcGxpdCgnLycpLmxlbmd0aFxuICAgIHdoaWxlIChzcGxpdENvdW50KSB7XG4gICAgICByZWxhdGl2ZVNwbGl0LnNoaWZ0KCkgLy8gcmVtb3ZlIHN0YXJ0aW5nIG5vdGF0aW9ucyBvbiBzYWZhcmkgcmVzdWx0c1xuICAgICAgLS1zcGxpdENvdW50XG4gICAgfVxuICB9XG4gIHJldHVybiByZWxhdGl2ZVNwbGl0LmpvaW4oJy8nKVxufSJdfQ==